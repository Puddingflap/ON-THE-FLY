<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>ASTER OID</title>
  <style>
    :root{
      --bg:#070b14; --fg:#e8f0ff; --accent:#6ee7ff; --accent2:#ffcc6e; --shadow:0 10px 30px rgba(0,0,0,.35);
      --muted:#6b7280;
    }
    html,body{height:100%;margin:0}
    body{
      background: radial-gradient(1200px 800px at 70% 20%, rgba(110,231,255,.06), transparent), var(--bg);
      color:var(--fg); font-family: system-ui, sans-serif; overflow:hidden;
    }
    #wrap{position:fixed; inset:0; display:grid; place-items:center}
    canvas{
      width: min(100vw, 100vh*0.5625);
      height: min(100vh, 100vw/0.5625);
      max-width:100vw; max-height:100vh;
      box-shadow: var(--shadow); border-radius: 18px; background: transparent;
    }
    .hud{position:fixed; inset:0; pointer-events:none; display:flex; align-items:center; justify-content:center;}
    .panel{pointer-events:auto; position:absolute; top:24px; left:50%; transform:translateX(-50%);
      background: rgba(8,12,22,.6); border:1px solid rgba(255,255,255,.08); backdrop-filter: blur(6px);
      padding:10px 14px; border-radius:14px; display:flex; gap:18px; align-items:center}
    .panel .pill{background:rgba(255,255,255,.08); padding:6px 10px; border-radius:999px; font-weight:700; letter-spacing:.3px}
    .btn{
      pointer-events:auto; position:absolute; bottom:24px; left:50%; transform:translateX(-50%);
      background:linear-gradient(180deg, rgba(110,231,255,.18), rgba(110,231,255,.12));
      border:1px solid rgba(110,231,255,.4); color:var(--fg); font-weight:700; letter-spacing:.3px;
      padding:12px 18px; border-radius:14px; box-shadow: var(--shadow); text-decoration:none;
    }
    .hint{position:absolute; bottom:86px; left:50%; transform:translateX(-50%); color:var(--muted); font-size:14px}
    .title{position:absolute; top:50%; left:50%; transform:translate(-50%, -60%); text-align:center}
    h1{margin:0 0 6px 0; font-size: clamp(28px, 6vw, 48px)}
    .toast{position:absolute; top:14px; right:14px; background:rgba(20,30,45,.9); border:1px solid rgba(255,255,255,.15);
      color:#e6f0ff; padding:8px 12px; border-radius:12px; font-size:12px; pointer-events:auto}
    .toast.ok{background:rgba(30,55,35,.9); border-color:rgba(120,255,170,.35); color:#d7ffe8}
    .toast.err{background:rgba(55,30,30,.9); border-color:rgba(255,120,120,.35); color:#ffe1e1}
  </style>
</head>
<body>
  <div id="wrap">
    <canvas id="game" width="1280" height="720" aria-label="ASTER OID"></canvas>
  </div>

  <div class="hud" aria-live="polite">
    <div class="panel" id="scorePanel" hidden>
      <span class="pill">Score: <span id="score">0</span></span>
      <span class="pill">Best: <span id="best">0</span></span>
    </div>
    <div class="title" id="title">
      <h1>ðŸ’« ASTER OID</h1>
      <div class="subtitle">Tap/Click or press <strong>SPACE</strong> to boost</div>
    </div>
    <div class="hint" id="hint">Tip: stay centered, read the gaps, boost at the last moment.</div>
    <button class="btn" id="startBtn" aria-label="Start game (or press space)">Start</button>
    <div class="toast" id="toast" hidden>â€¦</div>
  </div>

<script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));

  function resize() {
    const rect = canvas.getBoundingClientRect();
    canvas.width = Math.round(rect.width * DPR);
    canvas.height = Math.round(rect.height * DPR);
  }
  resize();
  window.addEventListener('resize', resize);

  const G = 2600, FLAP_VY = -850, MAX_DROP = 1200;
  const SCROLL_SPEED = 180;
  const AST = { r: 28, x: 200, y: 300 };

  let state = 'start', tPrev = 0, speed = SCROLL_SPEED, paused = false;

  const ui = {
    scorePanel: document.getElementById('scorePanel'),
    score: document.getElementById('score'),
    best: document.getElementById('best'),
    startBtn: document.getElementById('startBtn'),
    title: document.getElementById('title'),
    hint: document.getElementById('hint'),
    toast: document.getElementById('toast'),
  };
  ui.best.textContent = +(localStorage.getItem('aster-oid-best')||0);

  // ---------- Image loader that tries multiple paths ----------
  const IMG_SOURCES = ['assets/cz-droid.png', 'cz-droid.png']; // adjust here if needed
  let czImg = new Image();
  let imgReady = false;
  let tried = 0;

  function showToast(msg, ok=false) {
    ui.toast.textContent = msg;
    ui.toast.classList.remove('ok','err');
    ui.toast.classList.add(ok ? 'ok' : 'err');
    ui.toast.hidden = false;
    setTimeout(() => { ui.toast.hidden = true; }, 4000);
    console.log(msg);
  }

  function tryNextImage() {
    if (tried >= IMG_SOURCES.length) {
      showToast('Image not found at: ' + IMG_SOURCES.join(' or '), false);
      return;
    }
    const src = IMG_SOURCES[tried++];
    czImg = new Image();
    czImg.onload = () => {
      imgReady = true;
      showToast('Loaded sprite: ' + src, true);
    };
    czImg.onerror = () => {
      showToast('Failed to load: ' + src, false);
      tryNextImage();
    };
    czImg.src = src;
  }
  tryNextImage();

  const stars = Array.from({length: 120}, () => ({
    x: Math.random()*canvas.width, y: Math.random()*canvas.height,
    z: 0.3 + Math.random()*0.7, r: 0.6 + Math.random()*1.8,
  }));

  const player = {
    x: AST.x, y: AST.y, r: AST.r,
    vy: 0, rot: 0,
    flap(){ this.vy = FLAP_VY; },
    update(dt){
      this.vy = Math.min(this.vy + G*dt, MAX_DROP);
      this.y += this.vy * dt;
      this.rot = Math.max(-0.6, Math.min(0.9, this.vy/900));
    },
    draw(){
      ctx.save();
      ctx.translate(this.x*DPR, this.y*DPR);
      ctx.rotate(this.rot);
      const r = this.r * DPR;
      if (imgReady) {
        ctx.drawImage(czImg, -r, -r, r*2, r*2);
      } else {
        // fallback: ALWAYS visible golden circle so you see something
        ctx.fillStyle = '#ffcc6e';
        ctx.beginPath(); ctx.arc(0,0,r,0,Math.PI*2); ctx.fill();
      }
      ctx.restore();
    }
  };

  function setUI(){
    const isStart = state === 'start';
    ui.title.style.display = isStart ? '' : 'none';
    ui.hint.style.display = isStart ? '' : 'none';
    ui.startBtn.style.display = isStart ? '' : 'none';
    ui.scorePanel.hidden = state !== 'playing';
  }

  function startGame() {
    state = 'playing';
    tPrev = 0; speed = SCROLL_SPEED;
    player.y = AST.y; player.vy = 0;
    setUI();
  }

  function boost() {
    if (state === 'start') startGame();
    else if (state === 'playing') player.flap();
  }

  window.addEventListener('keydown', e => {
    if (['Space','ArrowUp','KeyW'].includes(e.code)) { e.preventDefault(); boost(); }
  });
  window.addEventListener('pointerdown', e => { if (e.target === canvas) boost(); });
  ui.startBtn.addEventListener('click', boost);

  document.addEventListener('visibilitychange', () => { paused = document.hidden; });

  function update(dt){ if (state === 'playing') player.update(dt); }

  function draw(){
    // background
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const g = ctx.createLinearGradient(0,0,0,canvas.height);
    g.addColorStop(0,'#091224'); g.addColorStop(1,'#05070f');
    ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width,canvas.height);
    // stars
    for (const s of stars) {
      s.x -= (speed * s.z * 0.08) * (1/60) * DPR;
      if (s.x < -2) { s.x = canvas.width + Math.random()*40; s.y = Math.random()*canvas.height; }
      ctx.globalAlpha = 0.5 + s.z*0.5;
      ctx.beginPath(); ctx.arc(s.x, s.y, s.r*DPR, 0, Math.PI*2); ctx.fillStyle = '#e8f0ff'; ctx.fill();
    }
    ctx.globalAlpha = 1;
    // player
    player.draw();
  }

  function loop(ts){
    if (paused) { tPrev = ts; requestAnimationFrame(loop); return; }
    const dt = Math.min(0.033, (tPrev ? (ts - tPrev)/1000 : 0.016));
    tPrev = ts;
    update(dt);
    draw();
    requestAnimationFrame(loop);
  }
  setUI();
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
